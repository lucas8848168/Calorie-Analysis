# P1 级优化 - 任务清单

**项目**: 食物卡路里分析器  
**版本**: P1 Tasks v1.0  
**创建日期**: 2025-11-20  
**预计工期**: 1-2 周  
**状态**: 📋 待开始

---

## 📊 任务概览

| 模块 | 任务数 | 预计工时 | 优先级 |
|------|--------|----------|--------|
| 数据模型 & 类型定义 | 6 | 4h | P0 |
| 多食物识别 | 5 | 8h | P1 |
| 餐次管理系统 | 8 | 12h | P1 |
| 数据可视化 | 6 | 10h | P1 |
| 目标管理系统 | 7 | 10h | P1 |
| 集成 & 测试 | 4 | 6h | P2 |
| **总计** | **36** | **50h** | - |

---

## 阶段 0: 基础准备 (P0 - 必须先完成)

### Task 0.1: 更新 TypeScript 类型定义
**文件**: `src/types/index.ts`  
**工时**: 2h  
**依赖**: 无

**任务内容**:
- [ ] 定义 `MealType` 枚举
- [ ] 定义 `MealRecord` 接口
- [ ] 定义 `FoodItem` 接口（增强版）
- [ ] 定义 `BoundingBox` 接口
- [ ] 定义 `UserGoal` 接口
- [ ] 定义 `GoalType` 枚举
- [ ] 定义 `FavoriteFood` 接口
- [ ] 定义 `MealTemplate` 接口
- [ ] 定义 `ReminderSettings` 接口
- [ ] 定义 `ChartDataPoint` 接口

**验收标准**:
- 所有类型定义完整且无 TypeScript 错误
- 类型定义符合设计文档规范

---

### Task 0.2: 创建数据服务层
**文件**: `src/services/`  
**工时**: 2h  
**依赖**: Task 0.1

**任务内容**:
- [ ] 创建 `mealService.ts` - 餐次数据 CRUD
- [ ] 创建 `goalService.ts` - 目标数据管理
- [ ] 创建 `favoriteService.ts` - 收藏数据管理
- [ ] 创建 `templateService.ts` - 模板数据管理
- [ ] 创建 `chartDataService.ts` - 图表数据计算
- [ ] 创建 `storageService.ts` - 统一存储接口

**验收标准**:
- 所有服务提供完整的 CRUD 方法
- 数据持久化到 LocalStorage
- 提供数据查询和过滤方法

---

## 阶段 1: 多食物识别增强 (P1)

### Task 1.1: 创建图片标注组件
**文件**: `src/components/ImageAnnotator/`  
**工时**: 3h  
**依赖**: Task 0.1

**任务内容**:
- [ ] 创建 `ImageAnnotator.tsx` 主组件
- [ ] 创建 `SelectionBox.tsx` 选择框组件
- [ ] 实现鼠标拖拽绘制选择框
- [ ] 实现选择框的调整和删除
- [ ] 添加多选择框支持
- [ ] 创建 `ImageAnnotator.css` 样式

**验收标准**:
- 可以在图片上绘制多个选择框
- 选择框可以调整大小和位置
- 选择框可以删除
- 返回选择框坐标信息

---

### Task 1.2: 增强 ImageUploader 组件
**文件**: `src/components/ImageUploader/ImageUploader.tsx`  
**工时**: 2h  
**依赖**: Task 1.1

**任务内容**:
- [ ] 集成 ImageAnnotator 组件
- [ ] 添加"分析全部"和"分析选中区域"按钮
- [ ] 实现区域坐标传递给 API
- [ ] 添加多区域分析模式
- [ ] 更新 UI 显示标注提示

**验收标准**:
- 用户可以选择分析模式
- 区域坐标正确传递
- UI 提示清晰友好

---

### Task 1.3: 更新 API 客户端支持多食物
**文件**: `src/services/apiClient.ts`  
**工时**: 2h  
**依赖**: Task 1.2

**任务内容**:
- [ ] 修改 API 请求支持区域参数
- [ ] 处理多食物识别响应
- [ ] 添加 boundingBox 信息到结果
- [ ] 错误处理优化

**验收标准**:
- API 可以接收区域坐标
- 返回多个食物的识别结果
- 每个食物包含位置信息

---

### Task 1.4: 创建多食物结果显示组件
**文件**: `src/components/MultiFoodResult/`  
**工时**: 2h  
**依赖**: Task 1.3

**任务内容**:
- [ ] 创建 `MultiFoodResult.tsx`
- [ ] 显示食物列表（可编辑）
- [ ] 支持单个食物的删除
- [ ] 支持份量调整
- [ ] 显示总计营养信息
- [ ] 创建样式文件

**验收标准**:
- 清晰显示所有识别的食物
- 可以编辑和删除单个食物
- 总计信息实时更新

---

### Task 1.5: 集成测试多食物识别流程
**文件**: 测试文件  
**工时**: 1h  
**依赖**: Task 1.4

**任务内容**:
- [ ] 测试单区域识别
- [ ] 测试多区域识别
- [ ] 测试全图识别
- [ ] 测试结果编辑功能
- [ ] 修复发现的问题

**验收标准**:
- 所有识别模式正常工作
- 无明显 bug
- 用户体验流畅

---

## 阶段 2: 餐次管理系统 (P1)

### Task 2.1: 创建餐次时间轴组件
**文件**: `src/components/MealManager/MealTimeline.tsx`  
**工时**: 3h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 创建 MealTimeline 组件
- [ ] 实现日期选择器
- [ ] 显示每日目标和进度条
- [ ] 按餐次分组显示记录
- [ ] 添加"添加餐次"按钮
- [ ] 创建样式文件

**验收标准**:
- 时间轴清晰显示一天的饮食
- 可以切换日期
- 进度条准确显示摄入情况

---

### Task 2.2: 创建餐次卡片组件
**文件**: `src/components/MealManager/MealCard.tsx`  
**工时**: 2h  
**依赖**: Task 2.1

**任务内容**:
- [ ] 创建 MealCard 组件
- [ ] 显示餐次类型和时间
- [ ] 显示食物列表
- [ ] 显示小计营养信息
- [ ] 添加编辑/删除功能
- [ ] 创建样式文件

**验收标准**:
- 卡片美观清晰
- 信息完整准确
- 交互流畅

---

### Task 2.3: 创建餐次类型选择器
**文件**: `src/components/MealManager/MealTypeSelector.tsx`  
**工时**: 1h  
**依赖**: Task 0.1

**任务内容**:
- [ ] 创建选择器组件
- [ ] 支持4种餐次类型
- [ ] 根据时间智能推荐餐次
- [ ] 添加图标和样式

**验收标准**:
- 可以选择餐次类型
- 智能推荐准确
- UI 友好

---

### Task 2.4: 创建快速添加面板
**文件**: `src/components/QuickAdd/QuickAddPanel.tsx`  
**工时**: 2h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 创建 QuickAddPanel 组件
- [ ] 集成常吃食物列表
- [ ] 集成最近食用列表
- [ ] 添加快速添加按钮
- [ ] 创建样式文件

**验收标准**:
- 面板显示常用食物
- 一键添加功能正常
- 布局美观

---

### Task 2.5: 创建常吃食物组件
**文件**: `src/components/QuickAdd/FavoriteFoods.tsx`  
**工时**: 2h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 创建 FavoriteFoods 组件
- [ ] 显示收藏的食物网格
- [ ] 实现添加到收藏功能
- [ ] 实现从收藏移除功能
- [ ] 按使用频率排序
- [ ] 创建样式文件

**验收标准**:
- 显示用户收藏的食物
- 可以管理收藏列表
- 按频率智能排序

---

### Task 2.6: 创建最近食用组件
**文件**: `src/components/QuickAdd/RecentFoods.tsx`  
**工时**: 1h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 创建 RecentFoods 组件
- [ ] 从历史记录提取最近食物
- [ ] 显示食物和时间
- [ ] 快速添加功能
- [ ] 创建样式文件

**验收标准**:
- 显示最近7天的食物
- 可以快速添加
- 信息清晰

---

### Task 2.7: 创建饮食模板管理
**文件**: `src/components/TemplateManager/`  
**工时**: 3h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 创建 TemplateList.tsx 列表组件
- [ ] 创建 TemplateEditor.tsx 编辑器
- [ ] 实现模板创建功能
- [ ] 实现模板应用功能
- [ ] 实现模板删除功能
- [ ] 创建样式文件

**验收标准**:
- 可以创建和保存模板
- 可以应用模板到餐次
- 可以管理模板列表

---

### Task 2.8: 更新 AnalysisDisplay 集成餐次
**文件**: `src/components/AnalysisDisplay.tsx`  
**工时**: 1h  
**依赖**: Task 2.1, 2.2

**任务内容**:
- [ ] 添加"保存到餐次"功能
- [ ] 集成餐次类型选择
- [ ] 保存时关联餐次信息
- [ ] 更新 UI 提示

**验收标准**:
- 分析结果可以保存到指定餐次
- 数据正确关联
- 用户体验流畅

---

## 阶段 3: 数据可视化 (P1)

### Task 3.1: 安装图表库
**文件**: `package.json`  
**工时**: 0.5h  
**依赖**: 无

**任务内容**:
- [ ] 安装 recharts 或 chart.js
- [ ] 配置图表库
- [ ] 测试基本图表渲染

**验收标准**:
- 图表库正常工作
- 无依赖冲突

---

### Task 3.2: 创建卡路里趋势图
**文件**: `src/components/Charts/CalorieTrendChart.tsx`  
**工时**: 3h  
**依赖**: Task 3.1, Task 0.2

**任务内容**:
- [ ] 创建 CalorieTrendChart 组件
- [ ] 实现折线图 + 柱状图组合
- [ ] 添加目标线显示
- [ ] 实现点击查看详情
- [ ] 添加数据标签
- [ ] 创建样式文件

**验收标准**:
- 图表清晰显示趋势
- 目标线准确显示
- 交互功能正常

---

### Task 3.3: 创建营养雷达图
**文件**: `src/components/Charts/NutritionRadarChart.tsx`  
**工时**: 2h  
**依赖**: Task 3.1, Task 0.2

**任务内容**:
- [ ] 创建 NutritionRadarChart 组件
- [ ] 实现雷达图显示
- [ ] 显示实际值 vs 目标值
- [ ] 添加图例说明
- [ ] 创建样式文件

**验收标准**:
- 雷达图准确显示营养比例
- 目标值对比清晰
- 视觉效果良好

---

### Task 3.4: 创建餐次分布图
**文件**: `src/components/Charts/MealDistributionChart.tsx`  
**工时**: 2h  
**依赖**: Task 3.1, Task 0.2

**任务内容**:
- [ ] 创建 MealDistributionChart 组件
- [ ] 实现饼图或环形图
- [ ] 显示各餐次占比
- [ ] 添加点击查看详情
- [ ] 创建样式文件

**验收标准**:
- 分布图清晰显示占比
- 颜色区分明显
- 交互功能正常

---

### Task 3.5: 创建时间维度选择器
**文件**: `src/components/Charts/TimePeriodSelector.tsx`  
**工时**: 1h  
**依赖**: 无

**任务内容**:
- [ ] 创建 TimePeriodSelector 组件
- [ ] 支持日/周/月切换
- [ ] 触发数据重新加载
- [ ] 创建样式文件

**验收标准**:
- 可以切换时间维度
- 图表数据正确更新
- UI 清晰友好

---

### Task 3.6: 创建数据分析页面
**文件**: `src/pages/DataAnalysis.tsx`  
**工时**: 2h  
**依赖**: Task 3.2, 3.3, 3.4, 3.5

**任务内容**:
- [ ] 创建 DataAnalysis 页面
- [ ] 集成所有图表组件
- [ ] 实现时间维度切换
- [ ] 添加数据摘要卡片
- [ ] 创建样式文件

**验收标准**:
- 页面布局美观
- 所有图表正常显示
- 数据准确无误

---

## 阶段 4: 目标管理系统 (P1)

### Task 4.1: 创建目标设置组件
**文件**: `src/components/GoalManager/GoalSetup.tsx`  
**工时**: 3h  
**依赖**: Task 0.1, 0.2

**任务内容**:
- [ ] 创建 GoalSetup 组件
- [ ] 实现目标类型选择
- [ ] 实现体重目标设置
- [ ] 实现每日营养目标设置
- [ ] 实现目标日期选择
- [ ] 添加表单验证
- [ ] 创建样式文件

**验收标准**:
- 可以设置各类目标
- 表单验证完整
- 数据正确保存

---

### Task 4.2: 创建目标进度组件
**文件**: `src/components/GoalManager/GoalProgress.tsx`  
**工时**: 2h  
**依赖**: Task 4.1

**任务内容**:
- [ ] 创建 GoalProgress 组件
- [ ] 显示当前进度百分比
- [ ] 显示已坚持天数
- [ ] 显示预计剩余天数
- [ ] 添加进度条动画
- [ ] 创建样式文件

**验收标准**:
- 进度信息准确显示
- 进度条视觉效果好
- 数据实时更新

---

### Task 4.3: 创建目标卡片组件
**文件**: `src/components/GoalManager/GoalCard.tsx`  
**工时**: 2h  
**依赖**: Task 4.2

**任务内容**:
- [ ] 创建 GoalCard 组件
- [ ] 显示目标概览信息
- [ ] 显示每日目标达成情况
- [ ] 添加编辑/暂停按钮
- [ ] 创建样式文件

**验收标准**:
- 卡片信息完整
- 布局美观
- 交互流畅

---

### Task 4.4: 实现目标进度计算逻辑
**文件**: `src/services/goalService.ts`  
**工时**: 2h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 实现每日目标达成检查
- [ ] 实现总体进度计算
- [ ] 实现连续达标天数统计
- [ ] 实现预计完成时间计算
- [ ] 添加目标状态更新

**验收标准**:
- 计算逻辑准确
- 性能良好
- 边界情况处理完善

---

### Task 4.5: 创建提醒设置组件
**文件**: `src/components/GoalManager/ReminderSettings.tsx`  
**工时**: 2h  
**依赖**: Task 0.1

**任务内容**:
- [ ] 创建 ReminderSettings 组件
- [ ] 实现用餐提醒设置
- [ ] 实现饮水提醒设置
- [ ] 实现记录提醒设置
- [ ] 保存提醒配置
- [ ] 创建样式文件

**验收标准**:
- 可以配置各类提醒
- 设置正确保存
- UI 清晰易用

---

### Task 4.6: 实现浏览器通知功能
**文件**: `src/services/reminderService.ts`  
**工时**: 2h  
**依赖**: Task 4.5

**任务内容**:
- [ ] 请求通知权限
- [ ] 实现定时提醒逻辑
- [ ] 发送浏览器通知
- [ ] 处理通知点击事件
- [ ] 添加提醒历史记录

**验收标准**:
- 通知按时触发
- 通知内容准确
- 用户可以管理通知

---

### Task 4.7: 创建目标管理页面
**文件**: `src/pages/GoalManagement.tsx`  
**工时**: 1h  
**依赖**: Task 4.1, 4.2, 4.3, 4.5

**任务内容**:
- [ ] 创建 GoalManagement 页面
- [ ] 集成所有目标组件
- [ ] 实现页面布局
- [ ] 添加导航和路由
- [ ] 创建样式文件

**验收标准**:
- 页面布局合理
- 所有功能正常
- 用户体验良好

---

## 阶段 5: 集成与优化 (P2)

### Task 5.1: 更新主应用路由
**文件**: `src/App.tsx`  
**工时**: 1h  
**依赖**: Task 2.8, 3.6, 4.7

**任务内容**:
- [ ] 添加餐次管理路由
- [ ] 添加数据分析路由
- [ ] 添加目标管理路由
- [ ] 更新导航菜单
- [ ] 添加底部导航栏

**验收标准**:
- 所有页面可访问
- 路由切换流畅
- 导航清晰

---

### Task 5.2: 创建自定义 Hooks
**文件**: `src/hooks/`  
**工时**: 2h  
**依赖**: Task 0.2

**任务内容**:
- [ ] 创建 `useMealRecords.ts`
- [ ] 创建 `useGoalProgress.ts`
- [ ] 创建 `useChartData.ts`
- [ ] 创建 `useFavorites.ts`
- [ ] 优化数据获取逻辑

**验收标准**:
- Hooks 可复用
- 性能优化良好
- 代码简洁

---

### Task 5.3: 性能优化
**文件**: 多个文件  
**工时**: 2h  
**依赖**: 所有前置任务

**任务内容**:
- [ ] 添加 React.memo 优化组件
- [ ] 使用 useMemo 缓存计算
- [ ] 使用 useCallback 优化回调
- [ ] 实现虚拟滚动（如需要）
- [ ] 优化图片加载

**验收标准**:
- 页面渲染流畅
- 无明显卡顿
- 内存使用合理

---

### Task 5.4: 全面测试与修复
**文件**: 所有文件  
**工时**: 3h  
**依赖**: 所有前置任务

**任务内容**:
- [ ] 测试所有新功能
- [ ] 测试数据流转
- [ ] 测试边界情况
- [ ] 修复发现的 bug
- [ ] 优化用户体验
- [ ] 更新文档

**验收标准**:
- 所有功能正常工作
- 无严重 bug
- 用户体验流畅
- 代码质量良好

---

## 📝 任务执行建议

### 执行顺序
1. **第1天**: 完成阶段 0（基础准备）
2. **第2-3天**: 完成阶段 1（多食物识别）
3. **第4-6天**: 完成阶段 2（餐次管理）
4. **第7-8天**: 完成阶段 3（数据可视化）
5. **第9-10天**: 完成阶段 4（目标管理）
6. **第11-12天**: 完成阶段 5（集成优化）

### 每日工作流程
1. 选择当天任务
2. 阅读任务详情和验收标准
3. 参考设计文档实现
4. 完成后自测功能
5. 标记任务完成
6. 提交代码

### 注意事项
- 严格按照依赖关系执行任务
- 每完成一个任务立即测试
- 遇到问题及时记录和解决
- 保持代码质量和规范
- 定期提交代码避免丢失

---

**文档版本**: 1.0  
**最后更新**: 2025-11-20  
**状态**: ✅ 任务清单完成，可以开始执行


---

## 🗓️ 建议的任务执行顺序

### 第 1 天：基础架构搭建（4小时）

#### 上午（2小时）
**Task 0.1: 更新 TypeScript 类型定义**
- 对应优化：**全部功能的基础**
- 子任务：
  1. 定义 `MealType` 枚举（早/午/晚/加餐）→ 对应 **P1-2: 饮食记录增强**
  2. 定义 `MealRecord` 接口 → 对应 **P1-2: 饮食记录增强**
  3. 定义 `FoodItem` 接口（增强版，含 boundingBox）→ 对应 **P1-1: 多食物识别增强**
  4. 定义 `BoundingBox` 接口 → 对应 **P1-1: 多食物识别增强**
  5. 定义 `UserGoal` 接口 → 对应 **P1-4: 目标管理系统**
  6. 定义 `GoalType` 枚举 → 对应 **P1-4: 目标管理系统**
  7. 定义 `FavoriteFood` 接口 → 对应 **P1-2: 饮食记录增强（快速添加）**
  8. 定义 `MealTemplate` 接口 → 对应 **P1-2: 饮食记录增强（饮食模板）**
  9. 定义 `ReminderSettings` 接口 → 对应 **P1-4: 目标管理系统（智能提醒）**
  10. 定义 `ChartDataPoint` 接口 → 对应 **P1-3: 数据图表优化**

#### 下午（2小时）
**Task 0.2: 创建数据服务层**
- 对应优化：**全部功能的数据支撑**
- 子任务：
  1. 创建 `storageService.ts` - 统一存储接口 → 对应 **全部功能**
  2. 创建 `mealService.ts` - 餐次数据 CRUD → 对应 **P1-2: 饮食记录增强**
  3. 创建 `goalService.ts` - 目标数据管理 → 对应 **P1-4: 目标管理系统**
  4. 创建 `favoriteService.ts` - 收藏数据管理 → 对应 **P1-2: 饮食记录增强（快速添加）**
  5. 创建 `templateService.ts` - 模板数据管理 → 对应 **P1-2: 饮食记录增强（饮食模板）**
  6. 创建 `chartDataService.ts` - 图表数据计算 → 对应 **P1-3: 数据图表优化**

---

### 第 2 天：多食物识别功能（上）（4小时）

#### 上午（3小时）
**Task 1.1: 创建图片标注组件**
- 对应优化：**P1-1: 多食物识别增强 - 手动框选功能**
- 子任务：
  1. 创建 `ImageAnnotator.tsx` 主组件
  2. 创建 `SelectionBox.tsx` 选择框组件
  3. 实现鼠标拖拽绘制选择框
  4. 实现选择框的调整和删除
  5. 添加多选择框支持
  6. 创建 `ImageAnnotator.css` 样式

#### 下午（1小时）
**Task 1.2: 增强 ImageUploader 组件（部分）**
- 对应优化：**P1-1: 多食物识别增强 - 自动分割识别**
- 子任务：
  1. 集成 ImageAnnotator 组件
  2. 添加"分析全部"和"分析选中区域"按钮
  3. 更新 UI 显示标注提示

---

### 第 3 天：多食物识别功能（下）（4小时）

#### 上午（3小时）
**Task 1.2: 增强 ImageUploader 组件（完成）**
- 对应优化：**P1-1: 多食物识别增强**
- 子任务：
  4. 实现区域坐标传递给 API
  5. 添加多区域分析模式

**Task 1.3: 更新 API 客户端支持多食物**
- 对应优化：**P1-1: 多食物识别增强 - 后端集成**
- 子任务：
  1. 修改 API 请求支持区域参数
  2. 处理多食物识别响应
  3. 添加 boundingBox 信息到结果
  4. 错误处理优化

#### 下午（1小时）
**Task 1.4: 创建多食物结果显示组件**
- 对应优化：**P1-1: 多食物识别增强 - 结果展示**
- 子任务：
  1. 创建 `MultiFoodResult.tsx`
  2. 显示食物列表（可编辑）
  3. 支持单个食物的删除
  4. 支持份量调整
  5. 显示总计营养信息
  6. 创建样式文件

**Task 1.5: 集成测试多食物识别流程**
- 对应优化：**P1-1: 多食物识别增强 - 完整验证**

---

### 第 4 天：餐次管理系统（上）（4小时）

#### 上午（3小时）
**Task 2.1: 创建餐次时间轴组件**
- 对应优化：**P1-2: 饮食记录增强 - 餐次管理**
- 子任务：
  1. 创建 MealTimeline 组件
  2. 实现日期选择器
  3. 显示每日目标和进度条
  4. 按餐次分组显示记录
  5. 添加"添加餐次"按钮
  6. 创建样式文件

#### 下午（1小时）
**Task 2.3: 创建餐次类型选择器**
- 对应优化：**P1-2: 饮食记录增强 - 餐次管理**
- 子任务：
  1. 创建选择器组件
  2. 支持4种餐次类型（早/午/晚/加餐）
  3. 根据时间智能推荐餐次
  4. 添加图标和样式

---

### 第 5 天：餐次管理系统（中）（4小时）

#### 上午（2小时）
**Task 2.2: 创建餐次卡片组件**
- 对应优化：**P1-2: 饮食记录增强 - 餐次管理**
- 子任务：
  1. 创建 MealCard 组件
  2. 显示餐次类型和时间
  3. 显示食物列表
  4. 显示小计营养信息
  5. 添加编辑/删除功能
  6. 创建样式文件

#### 下午（2小时）
**Task 2.4: 创建快速添加面板**
- 对应优化：**P1-2: 饮食记录增强 - 快速添加功能**
- 子任务：
  1. 创建 QuickAddPanel 组件
  2. 集成常吃食物列表
  3. 集成最近食用列表
  4. 添加快速添加按钮
  5. 创建样式文件

---

### 第 6 天：餐次管理系统（下）（4小时）

#### 上午（3小时）
**Task 2.5: 创建常吃食物组件**
- 对应优化：**P1-2: 饮食记录增强 - 快速添加（常吃食物收藏）**
- 子任务：
  1. 创建 FavoriteFoods 组件
  2. 显示收藏的食物网格
  3. 实现添加到收藏功能
  4. 实现从收藏移除功能
  5. 按使用频率排序
  6. 创建样式文件

**Task 2.6: 创建最近食用组件**
- 对应优化：**P1-2: 饮食记录增强 - 快速添加（最近吃过）**
- 子任务：
  1. 创建 RecentFoods 组件
  2. 从历史记录提取最近食物
  3. 显示食物和时间
  4. 快速添加功能
  5. 创建样式文件

#### 下午（1小时）
**Task 2.8: 更新 AnalysisDisplay 集成餐次**
- 对应优化：**P1-2: 饮食记录增强 - 保存到餐次**
- 子任务：
  1. 添加"保存到餐次"功能
  2. 集成餐次类型选择
  3. 保存时关联餐次信息
  4. 更新 UI 提示

---

### 第 7 天：饮食模板 + 图表准备（4小时）

#### 上午（3小时）
**Task 2.7: 创建饮食模板管理**
- 对应优化：**P1-2: 饮食记录增强 - 饮食模板**
- 子任务：
  1. 创建 TemplateList.tsx 列表组件
  2. 创建 TemplateEditor.tsx 编辑器
  3. 实现模板创建功能
  4. 实现模板应用功能
  5. 实现模板删除功能
  6. 创建样式文件

#### 下午（1小时）
**Task 3.1: 安装图表库**
- 对应优化：**P1-3: 数据图表优化 - 基础准备**
- 子任务：
  1. 安装 recharts 或 chart.js
  2. 配置图表库
  3. 测试基本图表渲染

---

### 第 8 天：数据可视化（上）（4小时）

#### 上午（3小时）
**Task 3.2: 创建卡路里趋势图**
- 对应优化：**P1-3: 数据图表优化 - 卡路里趋势图**
- 子任务：
  1. 创建 CalorieTrendChart 组件
  2. 实现折线图 + 柱状图组合
  3. 添加目标线显示
  4. 实现点击查看详情
  5. 添加数据标签
  6. 创建样式文件

#### 下午（1小时）
**Task 3.5: 创建时间维度选择器**
- 对应优化：**P1-3: 数据图表优化 - 时间维度切换**
- 子任务：
  1. 创建 TimePeriodSelector 组件
  2. 支持日/周/月切换
  3. 触发数据重新加载
  4. 创建样式文件

---

### 第 9 天：数据可视化（下）（4小时）

#### 上午（2小时）
**Task 3.3: 创建营养雷达图**
- 对应优化：**P1-3: 数据图表优化 - 营养均衡雷达图**
- 子任务：
  1. 创建 NutritionRadarChart 组件
  2. 实现雷达图显示
  3. 显示实际值 vs 目标值
  4. 添加图例说明
  5. 创建样式文件

**Task 3.4: 创建餐次分布图**
- 对应优化：**P1-3: 数据图表优化 - 餐次分布**
- 子任务：
  1. 创建 MealDistributionChart 组件
  2. 实现饼图或环形图
  3. 显示各餐次占比
  4. 添加点击查看详情
  5. 创建样式文件

#### 下午（2小时）
**Task 3.6: 创建数据分析页面**
- 对应优化：**P1-3: 数据图表优化 - 完整页面集成**
- 子任务：
  1. 创建 DataAnalysis 页面
  2. 集成所有图表组件
  3. 实现时间维度切换
  4. 添加数据摘要卡片
  5. 创建样式文件

---

### 第 10 天：目标管理系统（上）（4小时）

#### 上午（3小时）
**Task 4.1: 创建目标设置组件**
- 对应优化：**P1-4: 目标管理系统 - 多维度目标**
- 子任务：
  1. 创建 GoalSetup 组件
  2. 实现目标类型选择（减重/增肌/健康）
  3. 实现体重目标设置
  4. 实现每日营养目标设置
  5. 实现目标日期选择
  6. 添加表单验证
  7. 创建样式文件

#### 下午（1小时）
**Task 4.4: 实现目标进度计算逻辑**
- 对应优化：**P1-4: 目标管理系统 - 进度追踪**
- 子任务：
  1. 实现每日目标达成检查
  2. 实现总体进度计算
  3. 实现连续达标天数统计
  4. 实现预计完成时间计算
  5. 添加目标状态更新

---

### 第 11 天：目标管理系统（下）（4小时）

#### 上午（2小时）
**Task 4.2: 创建目标进度组件**
- 对应优化：**P1-4: 目标管理系统 - 进度可视化**
- 子任务：
  1. 创建 GoalProgress 组件
  2. 显示当前进度百分比
  3. 显示已坚持天数
  4. 显示预计剩余天数
  5. 添加进度条动画
  6. 创建样式文件

**Task 4.3: 创建目标卡片组件**
- 对应优化：**P1-4: 目标管理系统 - 目标展示**
- 子任务：
  1. 创建 GoalCard 组件
  2. 显示目标概览信息
  3. 显示每日目标达成情况
  4. 添加编辑/暂停按钮
  5. 创建样式文件

#### 下午（2小时）
**Task 4.5: 创建提醒设置组件**
- 对应优化：**P1-4: 目标管理系统 - 智能提醒**
- 子任务：
  1. 创建 ReminderSettings 组件
  2. 实现用餐提醒设置
  3. 实现饮水提醒设置
  4. 实现记录提醒设置
  5. 保存提醒配置
  6. 创建样式文件

**Task 4.6: 实现浏览器通知功能**
- 对应优化：**P1-4: 目标管理系统 - 智能提醒**
- 子任务：
  1. 请求通知权限
  2. 实现定时提醒逻辑
  3. 发送浏览器通知
  4. 处理通知点击事件
  5. 添加提醒历史记录

---

### 第 12 天：集成与优化（4小时）

#### 上午（2小时）
**Task 4.7: 创建目标管理页面**
- 对应优化：**P1-4: 目标管理系统 - 完整页面集成**
- 子任务：
  1. 创建 GoalManagement 页面
  2. 集成所有目标组件
  3. 实现页面布局
  4. 添加导航和路由
  5. 创建样式文件

**Task 5.1: 更新主应用路由**
- 对应优化：**全部功能 - 导航集成**
- 子任务：
  1. 添加餐次管理路由
  2. 添加数据分析路由
  3. 添加目标管理路由
  4. 更新导航菜单
  5. 添加底部导航栏

#### 下午（2小时）
**Task 5.2: 创建自定义 Hooks**
- 对应优化：**全部功能 - 代码优化**
- 子任务：
  1. 创建 `useMealRecords.ts` → 对应 **P1-2: 饮食记录增强**
  2. 创建 `useGoalProgress.ts` → 对应 **P1-4: 目标管理系统**
  3. 创建 `useChartData.ts` → 对应 **P1-3: 数据图表优化**
  4. 创建 `useFavorites.ts` → 对应 **P1-2: 饮食记录增强**
  5. 优化数据获取逻辑

---

### 第 13 天：性能优化与测试（4小时）

#### 上午（2小时）
**Task 5.3: 性能优化**
- 对应优化：**全部功能 - 性能提升**
- 子任务：
  1. 添加 React.memo 优化组件
  2. 使用 useMemo 缓存计算
  3. 使用 useCallback 优化回调
  4. 实现虚拟滚动（如需要）
  5. 优化图片加载

#### 下午（2小时）
**Task 5.4: 全面测试与修复**
- 对应优化：**全部功能 - 质量保证**
- 子任务：
  1. 测试 **P1-1: 多食物识别增强** 所有功能
  2. 测试 **P1-2: 饮食记录增强** 所有功能
  3. 测试 **P1-3: 数据图表优化** 所有功能
  4. 测试 **P1-4: 目标管理系统** 所有功能
  5. 测试数据流转和边界情况
  6. 修复发现的 bug
  7. 优化用户体验
  8. 更新文档

---

## 📊 P1 优化需求与任务映射表

| P1 优化需求 | 对应任务 | 预计工时 |
|------------|---------|---------|
| **P1-1: 多食物识别增强** | Task 1.1 - 1.5 | 8h |
| └─ 手动框选功能 | Task 1.1, 1.2 | 5h |
| └─ 自动分割识别 | Task 1.2, 1.3 | 4h |
| └─ 结果展示与编辑 | Task 1.4, 1.5 | 3h |
| **P1-2: 饮食记录增强** | Task 2.1 - 2.8 | 14h |
| └─ 餐次管理 | Task 2.1, 2.2, 2.3, 2.8 | 7h |
| └─ 快速添加功能 | Task 2.4, 2.5, 2.6 | 5h |
| └─ 饮食模板 | Task 2.7 | 3h |
| **P1-3: 数据图表优化** | Task 3.1 - 3.6 | 10.5h |
| └─ 卡路里趋势图 | Task 3.2 | 3h |
| └─ 营养雷达图 | Task 3.3 | 2h |
| └─ 餐次分布图 | Task 3.4 | 2h |
| └─ 时间维度切换 | Task 3.5 | 1h |
| └─ 页面集成 | Task 3.6 | 2h |
| **P1-4: 目标管理系统** | Task 4.1 - 4.7 | 13h |
| └─ 多维度目标 | Task 4.1 | 3h |
| └─ 进度追踪 | Task 4.2, 4.4 | 4h |
| └─ 进度可视化 | Task 4.3 | 2h |
| └─ 智能提醒 | Task 4.5, 4.6 | 4h |
| └─ 页面集成 | Task 4.7 | 1h |
| **基础架构** | Task 0.1, 0.2 | 4h |
| **集成优化** | Task 5.1 - 5.4 | 8h |
| **总计** | 36 个任务 | 50h |

---

## ✅ 每日验收检查清单

### 第 1 天验收
- [ ] 所有 TypeScript 类型定义无错误
- [ ] 所有数据服务可以正常 CRUD
- [ ] LocalStorage 读写正常

### 第 2-3 天验收
- [ ] 可以在图片上绘制选择框
- [ ] 可以选择"分析全部"或"分析选中区域"
- [ ] API 可以接收区域参数
- [ ] 多食物结果正确显示

### 第 4-6 天验收
- [ ] 时间轴正确显示每日饮食
- [ ] 可以按餐次添加食物
- [ ] 常吃食物和最近食用功能正常
- [ ] 分析结果可以保存到餐次

### 第 7 天验收
- [ ] 可以创建和应用饮食模板
- [ ] 图表库安装成功

### 第 8-9 天验收
- [ ] 三种图表正确显示数据
- [ ] 时间维度切换正常
- [ ] 数据分析页面布局美观

### 第 10-11 天验收
- [ ] 可以设置各类目标
- [ ] 进度计算准确
- [ ] 提醒功能正常工作

### 第 12-13 天验收
- [ ] 所有页面路由正常
- [ ] 性能优化生效
- [ ] 所有功能测试通过
- [ ] 无严重 bug

---

**执行建议**: 
- 每天结束前完成当日验收检查
- 遇到阻塞问题及时调整顺序
- 保持代码提交频率（每完成一个任务提交一次）
- 参考 `docs/P1_OPTIMIZATION_DESIGN.md` 获取详细设计规范
