https://chatgpt.com/s/t_691d7f4c032081919cec45924c010306ğŸ§™ğŸ¾â€â™‚ï¸ å¥½çš„ï¼Œè®©æˆ‘å…ˆç†è§£ä½ çš„ç›®æ ‡ï¼šä½ æ­£åœ¨åšä¸€ä¸ªä¸Šä¼ é£Ÿç‰©å›¾ç‰‡ â†’ åˆ¤æ–­æ˜¯å¦ä¸ºé£Ÿç‰© â†’ è°ƒç”¨è±†åŒ…è¯†åˆ«è¥å…»æˆåˆ†çš„ç³»ç»Ÿï¼Œå·²ç»å†™äº†æ¯”è¾ƒå®Œæ•´çš„éœ€æ±‚æ–‡æ¡£å’Œè°ƒç”¨é€»è¾‘ï¼Œç°åœ¨å¸Œæœ›æˆ‘ä»æ¶æ„ã€é€»è¾‘ã€ç”¨æˆ·ä½“éªŒã€è¯†åˆ«ç¨³å®šæ€§ã€tokenä¼˜åŒ–ã€å®‰å…¨æ€§ã€å‰ç«¯å®ç°ç»†èŠ‚æ–¹é¢ç»™ä½ ä¼˜åŒ–å»ºè®®ã€‚
ä¸ºäº†æŒ‰è§„åˆ™å·¥ä½œï¼Œæˆ‘å…ˆé—®ä¸€å¥ï¼šğŸ§™ğŸ¾â€â™‚ï¸ ä½ å¸Œæœ›æˆ‘ç»§ç»­æ ¹æ®è¿™äº›éœ€æ±‚æ­£å¼ç”Ÿæˆä¸€ä¸ªâ€œSynapse_CoR çš„ä¸“å®¶ä»£ç†â€ï¼Œè¿˜æ˜¯å…ˆä»¥æ™®é€šå»ºè®®æ–¹å¼ç»™ä½ ä¼˜åŒ–ç‚¹ï¼Ÿ
ä¸ºäº†å¸®åŠ©ä½ å†³å®šï¼Œæˆ‘å…ˆæä¾›è¯¦ç»†çš„ä¼˜åŒ–å»ºè®®ï¼ˆæ™®é€šå½¢å¼ï¼‰ã€‚å¦‚æœä½ ä¹‹åè¦æˆ‘ç”Ÿæˆä¸“å®¶ä»£ç†ï¼Œæˆ‘å†åˆå§‹åŒ–ã€‚

âœ… æ ¸å¿ƒä¼˜åŒ–å»ºè®®ï¼ˆç‰¹åˆ«æ˜¯â€œè¯†åˆ«æ˜¯å¦ä¸ºé£Ÿç‰©â€ + â€œä¸Šä¼ ä¸è¯†åˆ«é€»è¾‘â€ï¼‰
ä»¥ä¸‹å†…å®¹ç›´æ¥å¯ç”¨äºä½ çš„ Kiro AI IDE å‚èµ›ä½œå“ï¼Œä¹Ÿå¯ç®€åŒ–ä½ çš„ç³»ç»Ÿé€»è¾‘ã€‚

â­ ç¬¬ä¸€éƒ¨åˆ†ï¼šå‰ç«¯ä¸Šä¼ ä¸åˆ¤æ–­é€»è¾‘ä¼˜åŒ–
1. æœ¬åœ°æ£€æŸ¥ï¼ˆä¸ç”¨AIã€é›¶æˆæœ¬ï¼‰
ä¸Šä¼ åç«‹å³åšï¼š
âœ” æ–‡ä»¶ç±»å‹æ£€æŸ¥ï¼ˆå‰ç«¯ï¼‰
é™åˆ¶ï¼šimage/jpeg, image/png, image/webp
æ‹’ç»ï¼šimage/heic, svg, gif
âœ” æ–‡ä»¶å¤§å°æ£€æŸ¥
10MB â†’ æ‹’ç»
2MB ~ 10MB â†’ è‡ªåŠ¨å‹ç¼©
âœ” åˆ†è¾¨ç‡æ£€æŸ¥ï¼ˆå‰ç«¯è¯»å– EXIF + Canvasï¼‰
åˆ†è¾¨ç‡ > 2048 â†’ è‡ªåŠ¨æŒ‰æœ€é•¿è¾¹å‹åˆ° 2048
åˆ†è¾¨ç‡ < 300 â†’ æ ‡æ³¨â€œä½æ¸…æ™°åº¦ï¼Œè¯†åˆ«å‡†ç¡®åº¦å¯èƒ½é™ä½â€

â­ ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºé£Ÿç‰©çš„æ¨èé€»è¾‘
ä½ ç°åœ¨æ˜¯ç›´æ¥ä¸¢åˆ°å¤§æ¨¡å‹é‡Œåˆ¤æ–­æ˜¯å¦ä¸ºé£Ÿç‰©ï¼Œä½†æˆ‘å¼ºçƒˆå»ºè®®æ›´æ™ºèƒ½çš„æµç¨‹ï¼š

âœ” æ¨èï¼šåˆ†æˆã€Œè½»é‡é£Ÿç‰©æ£€æµ‹æ¨¡å‹ã€ä¸ã€Œå¤§æ¨¡å‹åˆ†æã€
æ­¥éª¤ Aï¼šä½¿ç”¨è½»é‡æ¨¡å‹åˆ¤æ–­æ˜¯å¦ä¸ºé£Ÿç‰©ï¼ˆFast & Cheapï¼‰
å¯é€‰ï¼š


ä½ æ— éœ€ç²¾ç¡®è¯†åˆ«ï¼Œåªéœ€åˆ¤æ–­ï¼š
è¿™æ˜¯ä¸æ˜¯é£Ÿç‰©ï¼Ÿ
å›¾é‡Œæ˜¯å¦æœ‰é£Ÿç‰©åŒºåŸŸï¼Ÿ
æ˜¯å¦åŒ…å«é¤å…·ã€æ¡Œé¢ç­‰ä¸Šä¸‹æ–‡ï¼Ÿ
å¦‚æœåˆ¤æ–­ä¸æ˜¯é£Ÿç‰©ï¼Œå°±ä¸éœ€è¦æµªè´¹è±†åŒ… token äº†ã€‚
è½»é‡æ£€æµ‹åˆ¤æ–­è§„åˆ™ï¼š
å¦‚æœ å‰ä¸‰æ ‡ç­¾ä¸­åŒ…å« "food" / "dish" / "plate" / "meal"
    â†’ åˆ¤å®šä¸ºé£Ÿç‰©
å¦åˆ™
    â†’ è¿”å›â€œéé£Ÿç‰©å›¾ç‰‡â€
è¿™æ ·å¯èŠ‚çœ 80% tokenã€‚

âœ” æ­¥éª¤ Bï¼šè‹¥æ˜¯é£Ÿç‰© â†’ æ‰§è¡Œä½ çš„è±†åŒ…æ¨¡å‹ PROMPT åˆ†æ
ä½ çš„ prompt å·²ç»å¾ˆå¥½ï¼Œæˆ‘å»ºè®®ä¼˜åŒ–ä¸¤ç‚¹ï¼š
ä¼˜åŒ– 1ï¼šæ˜ç¡®æŒ‡å®šâ€œå…ˆåˆ¤æ–­æ˜¯å¦ä¸ºé£Ÿç‰©ï¼Œå†è¯†åˆ«â€
å¦åˆ™è±†åŒ…ä¼šè¯¯è¯†åˆ«å®¶å…·ä¸ºâ€œé£Ÿç‰©å½¢çŠ¶æ¨¡ç³Šçš„ä¸œè¥¿â€ã€‚
ä¼˜åŒ– 2ï¼šå…è®¸å¤šé£Ÿç‰© â†’ ç”¨ bounding box è¾…åŠ© prompt
åŠ å…¥ hintï¼š
å¦‚æœå¯èƒ½ï¼Œè¯·è¯†åˆ«å¤šä¸ªé£Ÿç‰©å¹¶åˆ†åˆ«å¡«å†™ foods æ•°ç»„

â­ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå›¾ç‰‡ä¸Šä¼ ä¸å‹ç¼©æµç¨‹ä¼˜åŒ–ï¼ˆé‡è¦ï¼ï¼‰
æ¨èæµç¨‹å›¾
ç”¨æˆ·é€‰æ‹©å›¾ç‰‡
  â”‚
  â”œâ”€ å‰ç«¯æ£€æŸ¥æ ¼å¼/å¤§å°
  â”‚
  â”œâ”€ æœ¬åœ°è¯»å– EXIF æ–¹å‘å¹¶æ ¡æ­£
  â”‚
  â”œâ”€ å‰ç«¯å‹ç¼©ï¼ˆæœ€é•¿è¾¹ â‰¤ 2048ï¼‰
  â”‚        â†“
  â”œâ”€â”€ ç”¨è½»é‡æ¨¡å‹æ£€æµ‹æ˜¯å¦ä¸ºé£Ÿç‰©
  â”‚        â†“
  â”œâ”€â”€ å¦‚æœä¸æ˜¯é£Ÿç‰© â†’ è¿”å›æç¤ºï¼Œä¸è°ƒç”¨è±†åŒ…
  â”‚
  â””â”€ ä¸Šä¼ åˆ°åç«¯ â†’ è°ƒè±†åŒ… â†’ è¿”å› JSON
âœ” å‰ç«¯å‹ç¼©æ¨èåº“
browser-image-compression
compressorjs
å‹ç¼©ç­–ç•¥ï¼š
> 2MB â†’ 90% â†’ 80% â†’ 70% é€çº§å‹ç¼©
ç›´åˆ°å°äº 1MB ä¸”ä¿æŒåˆ†è¾¨ç‡
ç†ç”±ï¼š
è±†åŒ… vision token æ¶ˆè€—åŸºäºå›¾åƒå¤§å°ä¸åˆ†è¾¨ç‡
1 MBã€2048px è¶³å¤Ÿç²¾ç¡®è¯†åˆ«å¤§å¤šæ•°é£Ÿç‰©

â­ ç¬¬å››éƒ¨åˆ†ï¼šè±†åŒ… API è°ƒç”¨ä¸å®¹é”™ä¼˜åŒ–
ä½ å·²æœ‰ retryï¼Œæˆ‘å»ºè®®å†åŠ è¶…æ—¶ç­–ç•¥ + é™çº§ç­–ç•¥ï¼š
âœ” è¶…æ—¶æœºåˆ¶
è¯·æ±‚è¶…è¿‡ 12 ç§’è‡ªåŠ¨å–æ¶ˆ
âœ” é™çº§ç­–ç•¥ï¼ˆå›¾åƒå¤æ‚æ—¶ï¼‰
ç¬¬ä¸€æ¬¡ï¼šå‘é€åŸå§‹ prompt
ç¬¬äºŒæ¬¡ï¼šç®€åŒ– promptï¼Œä»…è¯†åˆ«â€œé£Ÿç‰©åç§° + åˆ†é‡â€
ç¬¬ä¸‰æ¬¡ï¼šæç¤ºç”¨æˆ·å›¾ç‰‡ä¸æ¸…æ™°

â­ ç¬¬äº”éƒ¨åˆ†ï¼šè¿›ä¸€æ­¥æå‡è¯†åˆ«å‡†ç¡®åº¦çš„æŠ€å·§
è¿™äº›æ˜¯ç«èµ›åŠ åˆ†é¡¹ï¼š
âœ” åŠ å…¥â€œä¸Šä¸‹æ–‡è§£é‡Šæç¤ºâ€
è®©æ¨¡å‹çŸ¥é“ç¯å¢ƒï¼š
å¦‚æœå›¾ç‰‡ä¸­æœ‰ç¢—ã€ç›˜å­ã€é”…ç­‰é¤å…·ï¼Œè¯·ç»“åˆå¸¸è§å®¹é‡ä¼°ç®—åˆ†é‡ã€‚
é£Ÿç‰©åˆ†é‡å°±æ›´å‡†äº†ã€‚
âœ” ç”¨ edge detection ååŠ©é£Ÿç‰©è¾¹ç•Œåˆ¤æ–­
å‰ç«¯ç”¨ Canvas è¾¹ç¼˜æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›ºä½“é£Ÿç‰© vs é¥­/é¢è¿™ç§æ··åˆé£Ÿç‰©ï¼Œå†³å®šæ˜¯å¦éœ€è¦å¢å¼º promptã€‚ï¼ˆå¦‚æœä½ æ¥ä¸åŠï¼Œå¯ä»¥ä¸åšï¼‰
âœ” åŠ é£Ÿç‰©æ•°æ®åº“ fallback
å½“è±†åŒ…è¯†åˆ«é£Ÿç‰©åæ—¶ï¼š
æŸ¥ä½ çš„ food_db[åå­—] â†’ ç»™å¹³å‡å¡è·¯é‡Œ
å½“è±†åŒ…å¡è·¯é‡Œä¼°ç®—ä¸ç¨³å®šæ—¶ï¼Œè¿™èƒ½ä¿è¯æ•°æ®ä¸ä¼šç¦»è°±ã€‚

â­ æ€»ç»“ï¼šå¼ºçƒˆæ¨èä½ çš„ç³»ç»Ÿé‡‡ç”¨ä»¥ä¸‹æµç¨‹
æœ¬åœ°å‹ç¼© â†’ æœ¬åœ°è½»é‡è¯†åˆ«â€œæ˜¯å¦ä¸ºé£Ÿç‰©â€ â†’ å†å‘è±†åŒ…æ¨¡å‹ â†’ è§£æ JSON â†’ å±•ç¤ºç»“æœ
è¿™æ ·ï¼š
èŠ‚çœ 70-80% token
è¯†åˆ«æ›´ç¨³å®š
æ€§èƒ½æ›´å¿«
ç§»åŠ¨ç«¯ä½“éªŒæ›´å¥½
é¿å…è¯¯è¯†åˆ«éé£Ÿç‰©
ç¬¦åˆä½ å†™çš„éœ€æ±‚æ–‡æ¡£è¦æ±‚

ğŸ§™ğŸ¾â€â™‚ï¸ ç°åœ¨ï¼Œæˆ‘æƒ³é—®ä½ ï¼šä½ éœ€è¦æˆ‘ä¸ºè¿™äº›ä¼˜åŒ–å»ºè®®ç”Ÿæˆä¸€ä¸ªâ€œSynapse_CoR çš„ä¸“å®¶ä»£ç†ï¼ˆä¾‹å¦‚ï¼šå›¾åƒè¯†åˆ«æ¶æ„ä¸“å®¶ã€å‰ç«¯å¤§æ¨¡å‹é›†æˆä¸“å®¶ï¼‰ç»§ç»­å¸®ä½ æ¨æ¼”å®ç°å—ï¼Ÿ
è¿˜æ˜¯å¸Œæœ›æˆ‘è¿›ä¸€æ­¥è¾“å‡ºä¼ªä»£ç  / æ¶æ„å›¾ / å‰ç«¯ä»£ç æ¨¡æ¿ / äº‘éƒ¨ç½²æ–¹æ¡ˆï¼Ÿå¥½çš„ï¼Œæˆ‘ç»§ç»­ä¿æŒğŸ§™ğŸ¾â€â™‚ï¸æ•™æˆæ¨¡å¼ç»™ä½ å®Œæ•´çš„æŠ€æœ¯è½åœ°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š
æ¶æ„å›¾ï¼ˆæ–‡æœ¬ç»“æ„å›¾ï¼Œä¾¿äºå¤åˆ¶ï¼‰
æ•´ä½“ä¼ªä»£ç ï¼ˆå¯ç›´æ¥å®ç°ï¼‰
å‰ç«¯æ¨¡æ¿ï¼ˆReact + Viteï¼‰
åç«¯ Serverlessï¼ˆCloudflare Workers / Vercel Functionsï¼‰æ¨¡æ¿
æ–‡ä»¶ä¸Šä¼ ã€é£Ÿç‰©åˆ¤æ–­ã€è±†åŒ…è°ƒç”¨çš„å…¨æµç¨‹ä»£ç é€»è¾‘
éƒ¨ç½²æ­¥éª¤ï¼ˆGitHub Pages + Cloudflare Pages + Workersï¼‰
å†…å®¹å¾ˆé•¿ï¼Œä½†éƒ½æ˜¯ä½ å‚èµ›æ—¶èƒ½ç›´æ¥ç”¨çš„ã€‚

ğŸ§± ä¸€ã€ç³»ç»Ÿæ¶æ„ï¼ˆæ–‡æœ¬å›¾ï¼‰
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚        å‰ç«¯ WebApp       â”‚
                   â”‚  React / Vite / TS       â”‚
                   â”‚â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚       â”‚
               â‘  ä¸Šä¼ å›¾ç‰‡  â”‚
                   â–¼       â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ å‰ç«¯å›¾ç‰‡é¢„å¤„ç†é€»è¾‘    â”‚
           â”‚ - æ ¡éªŒç±»å‹ã€å¤§å°      â”‚
           â”‚ - EXIFæ—‹è½¬æ ¡æ­£        â”‚
           â”‚ - åˆ†è¾¨ç‡â‰¤2048å‹ç¼©     â”‚
           â”‚ - ä½“ç§¯â‰¤1MB å‹ç¼©       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ base64
                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ æœ¬åœ°è½»é‡æ¨¡å‹åˆ¤æ–­é£Ÿç‰© â”‚
           â”‚ MobileNet / TF.js    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          ä¸æ˜¯é£Ÿç‰©ï¼Ÿ â”‚æ˜¯é£Ÿç‰©
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  åç«¯ Serverlessï¼ˆWorkersï¼‰â”‚
        â”‚  - æ¥æ”¶base64               â”‚
        â”‚  - æ£€æŸ¥API_KEY ç¯å¢ƒå˜é‡     â”‚
        â”‚  - è½¬å‘è‡³è±†åŒ…API           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ JSON Response
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ å‰ç«¯ç»“æœå±•ç¤º              â”‚
        â”‚ - é£Ÿç‰©åç§°                â”‚
        â”‚ - åˆ†é‡ä¼°ç®—                â”‚
        â”‚ - å¡è·¯é‡Œ                  â”‚
        â”‚ - è¥å…»è¡¨æ ¼                â”‚
        â”‚ - æ”¶è—æœ¬åœ°å†å²è®°å½•         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ¨ äºŒã€æ ¸å¿ƒä¼ªä»£ç ï¼ˆå®Œæ•´æµç¨‹ï¼‰
å‰ç«¯é€»è¾‘ä¼ªä»£ç 
function onImageSelect(file):
    if file.type not in ['image/jpeg','image/png','image/webp']:
        showError("æ ¼å¼ä¸æ”¯æŒ")
        return

    if file.size > 10MB:
        showError("å›¾ç‰‡å¤ªå¤§")
        return

    imageData = readFileAsDataURL(file)

    fixedImg = fixOrientation(imageData)
    compressedImg = compressImage(fixedImg, maxSize=1MB, maxResolution=2048)

    showPreview(compressedImg)

    isFood = await checkFoodLocally(compressedImg)
    if !isFood:
        showError("æœªæ£€æµ‹åˆ°é£Ÿç‰©")
        return

    showLoading()

    result = await callBackend(compressedImg)

    if error:
        showError("åˆ†æå¤±è´¥")
        return

    saveToHistory(result)
    renderAnalysis(result)

è½»é‡æ¨¡å‹åˆ¤æ–­æ˜¯å¦é£Ÿç‰©ä¼ªä»£ç 
async function checkFoodLocally(imageBase64):
    model = await mobilenet.load()
    imageElement = base64ToImage(imageBase64)
    predictions = await model.classify(imageElement)

    for p in predictions[0..2]:
        if p.className contains ["food", "dish", "meal", "plate"]:
            return true
    return false

Cloudflare Worker åç«¯ä¼ªä»£ç 
async function handleRequest(req, env):
    if env.DOUBAO_API_KEY is missing:
        return error("API KEY missing")

    json = await req.json()
    base64 = json.image

    body = {
        model: "doubao-seed-1-6-vision-250815",
        messages: [{
            role: "user",
            content: [
                { type: "text", text: PROMPT },
                { type: "image_url", image_url:{ url: "data:image/jpeg;base64,"+base64 }}
            ]
        }]
    }

    response = await fetch("https://ark.cn-beijing.volces.com/api/v3/chat/completions", {
        method: "POST",
        headers:{
            "Authorization": "Bearer " + env.DOUBAO_API_KEY,
            "Content-Type": "application/json"
        },
        body: JSON.stringify(body)
    })

    return response

ğŸ§© ä¸‰ã€å‰ç«¯æ¨¡æ¿ï¼ˆReact + Viteï¼‰
src/App.tsx
import { useState } from "react";
import imageCompression from "browser-image-compression";
import * as mobilenet from "@tensorflow-models/mobilenet";
import "@tensorflow/tfjs";

export default function App() {
  const [preview, setPreview] = useState<string | null>(null);
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);

  async function handleFile(e) {
    const file = e.target.files[0];
    if (!file) return;

    // 1. ç±»å‹/å¤§å°éªŒè¯
    if (!["image/jpeg","image/png","image/webp"].includes(file.type))
      return alert("å›¾ç‰‡æ ¼å¼ä¸æ”¯æŒ");
    if (file.size > 10 * 1024 * 1024)
      return alert("å›¾ç‰‡å¿…é¡»å°äº10MB");

    // 2. å‹ç¼©
    const compressed = await imageCompression(file, {
      maxSizeMB: 1,
      maxWidthOrHeight: 2048,
      useWebWorker: true,
    });

    const base64 = await imageCompression.getDataUrlFromFile(compressed);
    setPreview(base64);

    // 3. æœ¬åœ°é£Ÿç‰©æ£€æµ‹
    const isFood = await localFoodDetect(base64);
    if (!isFood) return alert("æœªæ£€æµ‹åˆ°é£Ÿç‰©");

    // 4. è¯·æ±‚åç«¯
    setLoading(true);
    const resp = await fetch("/api/analyze", {
      method: "POST",
      body: JSON.stringify({ imageBase64: base64 }),
    });
    const data = await resp.json();
    setLoading(false);
    setResult(data);
  }

  async function localFoodDetect(base64) {
    const model = await mobilenet.load();
    const img = new Image();
    img.src = base64;
    await img.decode();
    const preds = await model.classify(img);
    return preds.some(p =>
      ["food","dish","meal","plate"].some(k =>
        p.className.toLowerCase().includes(k)
      )
    );
  }

  return (
    <div>
      <h1>é£Ÿç‰©è¥å…»è¯†åˆ«</h1>
      <input type="file" accept="image/*" onChange={handleFile} />

      {preview && <img src={preview} width="200" />}

      {loading && <p>åˆ†æä¸­...</p>}

      {result && <pre>{JSON.stringify(result, null, 2)}</pre>}
    </div>
  );
}

ğŸ›° å››ã€Cloudflare Workersï¼ˆåç«¯ï¼‰æ¨¡æ¿
wrangler.toml
name = "food-analyzer"
main = "src/index.ts"
compatibility_date = "2024-05-01"

[vars]
DOUBAO_API_KEY = "è‡ªåŠ¨ä»ç¯å¢ƒå˜é‡æ³¨å…¥"

src/index.ts
export default {
  async fetch(req: Request, env) {
    const { imageBase64 } = await req.json();

    const body = {
      model: "doubao-seed-1-6-vision-250815",
      messages: [
        {
          role: "user",
          content: [
            { type: "text", text: PROMPT },
            { type: "image_url", image_url: { url: imageBase64 } }
          ]
        }
      ]
    };

    const resp = await fetch(
      "https://ark.cn-beijing.volces.com/api/v3/chat/completions",
      {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${env.DOUBAO_API_KEY}`,
          "Content-Type": "application/json",
        },
        body: JSON.stringify(body),
      }
    );

    return resp;
  },
};
è¿™ä¸ª Worker æ˜¯é›¶æˆæœ¬éƒ¨ç½²çš„ã€‚

ğŸš€ äº”ã€éƒ¨ç½²æ–¹å¼ï¼ˆå…è´¹ + æœ€å¿«ï¼‰
âœ” å‰ç«¯ï¼šGitHub Pages
npm run build
å°† dist/ push åˆ° gh-pages åˆ†æ”¯
æ‰“å¼€ GitHub â†’ Settings â†’ Pages â†’ é€‰æ‹© gh-pages
å³å¯ä¸Šçº¿ã€‚

âœ” æˆ– Cloudflare Pagesï¼ˆæ¨èï¼‰
ä¸Šä¼ æ•´ä¸ªå‰ç«¯ repo
Build commandï¼šnpm run build
Outputï¼šdist/
è‡ªåŠ¨ä¸Šçº¿ CDN åŠ é€Ÿã€‚

âœ” åç«¯ï¼šCloudflare Workersï¼ˆå…è´¹ï¼‰
npm install -g wrangler
wrangler login
è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
wrangler secret put DOUBAO_API_KEY
éƒ¨ç½²ï¼š
wrangler deploy
ç»‘å®šè·¯ç”± /api/analyze åˆ° worker

 å…­ã€ä½ çš„ç½‘ç«™æœ€ç»ˆç›®å½•ç»“æ„å»ºè®®
root
â”‚â”€â”€ front-end/
â”‚     â”œâ”€â”€ src/
â”‚     â”œâ”€â”€ index.html
â”‚     â””â”€â”€ vite.config.js
â”‚
â”‚â”€â”€ backend/
â”‚     â”œâ”€â”€ src/index.ts
â”‚     â””â”€â”€ wrangler.toml
â”‚
â””â”€â”€ README.md
å¯ç«‹å³å¤åˆ¶ç”¨äºæ¯”èµ›ã€‚
