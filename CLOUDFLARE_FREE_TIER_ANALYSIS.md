# Cloudflare å…è´¹éƒ¨ç½²å¯è¡Œæ€§åˆ†æ

**è¯„ä¼°æ—¥æœŸ**: 2025-11-20  
**é¡¹ç›®**: é£Ÿç‰©å¡è·¯é‡Œåˆ†æå™¨  
**ç›®æ ‡**: è¯„ä¼°æ˜¯å¦é€‚åˆåœ¨Cloudflareå…è´¹å¥—é¤ä¸Šéƒ¨ç½²

---

## æ‰§è¡Œæ‘˜è¦

**ç»“è®º**: âœ… **å®Œå…¨é€‚åˆå…è´¹éƒ¨ç½²**ï¼ˆMVPé˜¶æ®µï¼‰  
**ä¿¡å¿ƒåº¦**: 95%  
**å»ºè®®**: å…è´¹å¥—é¤è¶³å¤Ÿæ”¯æ’‘æ—©æœŸç”¨æˆ·ï¼ˆ<1000 DAUï¼‰

---

## Cloudflare å…è´¹å¥—é¤é™é¢

### 1. Cloudflare Pages (å‰ç«¯æ‰˜ç®¡)

| é¡¹ç›® | å…è´¹å¥—é¤é™é¢ | é¡¹ç›®éœ€æ±‚ | è¯„ä¼° |
|------|-------------|----------|------|
| **æ„å»ºæ¬¡æ•°** | 500æ¬¡/æœˆ | ~20æ¬¡/æœˆ | âœ… å……è¶³ |
| **å¸¦å®½** | æ— é™ | ~10GB/æœˆ | âœ… å……è¶³ |
| **è¯·æ±‚æ•°** | æ— é™ | ~100K/æœˆ | âœ… å……è¶³ |
| **æ–‡ä»¶å¤§å°** | 25MB/æ–‡ä»¶ | <5MB | âœ… å……è¶³ |
| **æ€»é¡¹ç›®å¤§å°** | æ— é™ | ~50MB | âœ… å……è¶³ |
| **è‡ªå®šä¹‰åŸŸå** | 100ä¸ª | 1ä¸ª | âœ… å……è¶³ |
| **å¹¶å‘æ„å»º** | 1ä¸ª | 1ä¸ª | âœ… å……è¶³ |

**è¯„ä¼°**: âœ… **å®Œå…¨æ»¡è¶³**

---

### 2. Cloudflare Workers (åç«¯API)

| é¡¹ç›® | å…è´¹å¥—é¤é™é¢ | é¡¹ç›®éœ€æ±‚ | è¯„ä¼° |
|------|-------------|----------|------|
| **è¯·æ±‚æ•°** | 100,000æ¬¡/å¤© | ~1,000æ¬¡/å¤© | âœ… å……è¶³ |
| **CPUæ—¶é—´** | 10ms/è¯·æ±‚ | ~5ms/è¯·æ±‚ | âœ… å……è¶³ |
| **è„šæœ¬å¤§å°** | 1MB | ~50KB | âœ… å……è¶³ |
| **ç¯å¢ƒå˜é‡** | 64ä¸ª | 2ä¸ª | âœ… å……è¶³ |
| **å­è¯·æ±‚** | 50ä¸ª/è¯·æ±‚ | 1ä¸ª/è¯·æ±‚ | âœ… å……è¶³ |

**è¯„ä¼°**: âœ… **å®Œå…¨æ»¡è¶³**

**å…³é”®è®¡ç®—**:
```
å‡è®¾åœºæ™¯ï¼š
- æ¯æ—¥æ´»è·ƒç”¨æˆ·: 100äºº
- æ¯äººæ¯å¤©è¯†åˆ«: 5æ¬¡
- æ¯æ—¥æ€»è¯·æ±‚: 100 Ã— 5 = 500æ¬¡

å…è´¹é¢åº¦: 100,000æ¬¡/å¤©
ä½¿ç”¨ç‡: 500 / 100,000 = 0.5%
```

**ç»“è®º**: å…è´¹é¢åº¦å¯ä»¥æ”¯æ’‘ **20,000 DAU** (æ¯äºº5æ¬¡è¯†åˆ«)

---

### 3. Cloudflare KV (é”®å€¼å­˜å‚¨)

| é¡¹ç›® | å…è´¹å¥—é¤é™é¢ | é¡¹ç›®éœ€æ±‚ | è¯„ä¼° |
|------|-------------|----------|------|
| **è¯»å–æ¬¡æ•°** | 100,000æ¬¡/å¤© | 0æ¬¡/å¤© | âœ… æœªä½¿ç”¨ |
| **å†™å…¥æ¬¡æ•°** | 1,000æ¬¡/å¤© | 0æ¬¡/å¤© | âœ… æœªä½¿ç”¨ |
| **å­˜å‚¨ç©ºé—´** | 1GB | 0GB | âœ… æœªä½¿ç”¨ |
| **é”®æ•°é‡** | æ— é™ | 0ä¸ª | âœ… æœªä½¿ç”¨ |

**å½“å‰çŠ¶æ€**: âŒ **æœªä½¿ç”¨** (æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°)  
**å•†ä¸šåŒ–å**: âš ï¸ **éœ€è¦ä»˜è´¹** (ç”¨äºä¼šè¯ã€ç¼“å­˜)

---

### 4. Cloudflare D1 (SQLæ•°æ®åº“)

| é¡¹ç›® | å…è´¹å¥—é¤é™é¢ | é¡¹ç›®éœ€æ±‚ | è¯„ä¼° |
|------|-------------|----------|------|
| **æ•°æ®åº“æ•°é‡** | 10ä¸ª | 0ä¸ª | âœ… æœªä½¿ç”¨ |
| **å­˜å‚¨ç©ºé—´** | 5GB | 0GB | âœ… æœªä½¿ç”¨ |
| **è¯»å–æ¬¡æ•°** | 500ä¸‡æ¬¡/å¤© | 0æ¬¡/å¤© | âœ… æœªä½¿ç”¨ |
| **å†™å…¥æ¬¡æ•°** | 10ä¸‡æ¬¡/å¤© | 0æ¬¡/å¤© | âœ… æœªä½¿ç”¨ |

**å½“å‰çŠ¶æ€**: âŒ **æœªä½¿ç”¨** (æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°)  
**å•†ä¸šåŒ–å**: âš ï¸ **å¯èƒ½ä¸å¤Ÿ** (éœ€è¦è¯„ä¼°)

---

### 5. Cloudflare R2 (å¯¹è±¡å­˜å‚¨)

| é¡¹ç›® | å…è´¹å¥—é¤é™é¢ | é¡¹ç›®éœ€æ±‚ | è¯„ä¼° |
|------|-------------|----------|------|
| **å­˜å‚¨ç©ºé—´** | 10GB | 0GB | âœ… æœªä½¿ç”¨ |
| **Aç±»æ“ä½œ** | 100ä¸‡æ¬¡/æœˆ | 0æ¬¡/æœˆ | âœ… æœªä½¿ç”¨ |
| **Bç±»æ“ä½œ** | 1000ä¸‡æ¬¡/æœˆ | 0æ¬¡/æœˆ | âœ… æœªä½¿ç”¨ |

**å½“å‰çŠ¶æ€**: âŒ **æœªä½¿ç”¨** (å›¾ç‰‡ä¸å­˜å‚¨)  
**å•†ä¸šåŒ–å**: âš ï¸ **éœ€è¦è¯„ä¼°** (ç”¨äºå­˜å‚¨ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡)

---

## å½“å‰é¡¹ç›®èµ„æºä½¿ç”¨åˆ†æ

### å‰ç«¯ (Cloudflare Pages)

**æ„å»ºäº§ç‰©å¤§å°**:
```bash
npm run build

# é¢„ä¼°å¤§å°
dist/
â”œâ”€â”€ index.html          ~5KB
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ index-xxx.js    ~500KB (React + Recharts + ä¸šåŠ¡ä»£ç )
â”‚   â”œâ”€â”€ index-xxx.css   ~50KB
â”‚   â””â”€â”€ fonts/          ~100KB
â””â”€â”€ images/             ~200KB

æ€»è®¡: ~850KB (è¿œå°äº25MBé™åˆ¶)
```

**å¸¦å®½ä½¿ç”¨**:
```
å‡è®¾åœºæ™¯ï¼š
- æ¯æ—¥è®¿é—®ç”¨æˆ·: 100äºº
- æ¯äººåŠ è½½é¡µé¢: 3æ¬¡
- æ¯æ¬¡ä¼ è¾“: 850KB

æ¯æ—¥å¸¦å®½: 100 Ã— 3 Ã— 850KB = 255MB
æ¯æœˆå¸¦å®½: 255MB Ã— 30 = 7.65GB

Cloudflare Pages: æ— é™å¸¦å®½ âœ…
```

**è¯„ä¼°**: âœ… **å®Œå…¨æ»¡è¶³**

---

### åç«¯ (Cloudflare Workers)

**è¯·æ±‚å¤„ç†æ—¶é—´**:
```javascript
// å…¸å‹çš„APIè°ƒç”¨æµç¨‹
async function handleRequest(request) {
  // 1. è§£æè¯·æ±‚ (~1ms)
  const { image } = await request.json();
  
  // 2. è°ƒç”¨è±†åŒ…API (~3000ms) - è¿™æ˜¯ä¸»è¦è€—æ—¶
  const result = await callDoubaoAPI(image);
  
  // 3. è¿”å›ç»“æœ (~1ms)
  return new Response(JSON.stringify(result));
}

// Workers CPUæ—¶é—´: ~2ms (ä¸åŒ…æ‹¬å¤–éƒ¨APIç­‰å¾…æ—¶é—´)
// å…è´¹é™é¢: 10ms/è¯·æ±‚ âœ…
```

**å…³é”®ç‚¹**: 
- Workersçš„CPUæ—¶é—´**ä¸åŒ…æ‹¬**ç­‰å¾…å¤–éƒ¨APIçš„æ—¶é—´
- è°ƒç”¨è±†åŒ…APIçš„ç­‰å¾…æ—¶é—´ï¼ˆ30-60ç§’ï¼‰ä¸è®¡å…¥CPUæ—¶é—´
- å®é™…CPUä½¿ç”¨ < 5msï¼Œè¿œä½äº10msé™åˆ¶

**è¯„ä¼°**: âœ… **å®Œå…¨æ»¡è¶³**

---

## æˆæœ¬åˆ†æ

### å½“å‰æ¶æ„ï¼ˆå…è´¹éƒ¨ç½²ï¼‰

| æœåŠ¡ | å…è´¹é¢åº¦ | å®é™…ä½¿ç”¨ | æˆæœ¬ |
|------|---------|----------|------|
| Pages (å‰ç«¯) | æ— é™å¸¦å®½ | ~8GB/æœˆ | $0 |
| Workers (åç«¯) | 10ä¸‡æ¬¡/å¤© | ~500æ¬¡/å¤© | $0 |
| è±†åŒ…AI API | æŒ‰é‡ä»˜è´¹ | ~500æ¬¡/å¤© | **$15-30/æœˆ** |
| **æ€»è®¡** | - | - | **$15-30/æœˆ** |

**å…³é”®æˆæœ¬**: è±†åŒ…AI APIè°ƒç”¨è´¹ç”¨

**è±†åŒ…APIå®šä»·** (ä¼°ç®—):
```
å‡è®¾ï¼š
- æ¯æ¬¡è¯†åˆ«æ¶ˆè€—: 1000 tokens
- Tokenä»·æ ¼: Â¥0.001/1K tokens
- æ¯æ—¥è¯†åˆ«: 500æ¬¡

æ¯æ—¥æˆæœ¬: 500 Ã— Â¥0.001 = Â¥0.5
æ¯æœˆæˆæœ¬: Â¥0.5 Ã— 30 = Â¥15 (~$2)

å®é™…å¯èƒ½æ›´é«˜ï¼ˆå›¾ç‰‡å¤§ã€å¤æ‚åœºæ™¯ï¼‰: Â¥50-100/æœˆ ($7-15)
```

**è¯„ä¼°**: âœ… **æˆæœ¬å¯æ§**

---

### å•†ä¸šåŒ–åï¼ˆéœ€è¦ä»˜è´¹ï¼‰

| æœåŠ¡ | å…è´¹é¢åº¦ | é¢„ä¼°ä½¿ç”¨ | è¶…å‡ºæˆæœ¬ |
|------|---------|----------|----------|
| Pages | æ— é™ | ~100GB/æœˆ | $0 |
| Workers | 10ä¸‡æ¬¡/å¤© | ~10ä¸‡æ¬¡/å¤© | $0 (åˆšå¥½) |
| D1 æ•°æ®åº“ | 5GB + 500ä¸‡è¯» | 10GB + 1000ä¸‡è¯» | **$5/æœˆ** |
| KVå­˜å‚¨ | 1GB + 10ä¸‡è¯» | 2GB + 50ä¸‡è¯» | **$5/æœˆ** |
| R2å­˜å‚¨ | 10GB | 50GB | **$2/æœˆ** |
| è±†åŒ…AI | - | ~10ä¸‡æ¬¡/æœˆ | **$200-500/æœˆ** |
| **æ€»è®¡** | - | - | **$212-512/æœˆ** |

**è¯„ä¼°**: âš ï¸ **éœ€è¦ä»˜è´¹å¥—é¤**

---

## å…è´¹éƒ¨ç½²çš„é™åˆ¶

### 1. ç”¨æˆ·è§„æ¨¡é™åˆ¶ âš ï¸

**å…è´¹å¥—é¤å¯æ”¯æ’‘**:
```
Workersé™é¢: 100,000æ¬¡/å¤©

åœºæ™¯1 - è½»åº¦ä½¿ç”¨:
- æ¯ç”¨æˆ·æ¯å¤©: 3æ¬¡è¯†åˆ«
- å¯æ”¯æ’‘ç”¨æˆ·: 33,333 DAU âœ…

åœºæ™¯2 - ä¸­åº¦ä½¿ç”¨:
- æ¯ç”¨æˆ·æ¯å¤©: 10æ¬¡è¯†åˆ«
- å¯æ”¯æ’‘ç”¨æˆ·: 10,000 DAU âœ…

åœºæ™¯3 - é‡åº¦ä½¿ç”¨:
- æ¯ç”¨æˆ·æ¯å¤©: 50æ¬¡è¯†åˆ«
- å¯æ”¯æ’‘ç”¨æˆ·: 2,000 DAU âš ï¸
```

**ç»“è®º**: å…è´¹å¥—é¤è¶³å¤Ÿæ”¯æ’‘ **1ä¸‡æ—¥æ´»ç”¨æˆ·**ï¼ˆä¸­åº¦ä½¿ç”¨ï¼‰

---

### 2. åŠŸèƒ½é™åˆ¶ âš ï¸

**æ— æ³•å®ç°çš„åŠŸèƒ½**:

âŒ **ç”¨æˆ·è´¦å·ç³»ç»Ÿ**
- éœ€è¦D1æ•°æ®åº“å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
- å…è´¹é¢åº¦å¯èƒ½ä¸å¤Ÿï¼ˆå–å†³äºç”¨æˆ·é‡ï¼‰

âŒ **è·¨è®¾å¤‡æ•°æ®åŒæ­¥**
- éœ€è¦D1æ•°æ®åº“å­˜å‚¨ç”¨æˆ·æ•°æ®
- éœ€è¦KVå­˜å‚¨ä¼šè¯ä¿¡æ¯
- å…è´¹é¢åº¦å¯èƒ½ä¸å¤Ÿ

âŒ **ç¤¾äº¤åŠŸèƒ½**
- éœ€è¦å¤§é‡æ•°æ®åº“è¯»å†™
- éœ€è¦å®æ—¶é€šçŸ¥ï¼ˆDurable Objectsï¼‰
- å…è´¹é¢åº¦ä¸å¤Ÿ

âŒ **é«˜çº§åˆ†æ**
- éœ€è¦å¤§é‡æ•°æ®å¤„ç†
- å¯èƒ½è¶…å‡ºCPUæ—¶é—´é™åˆ¶

**å¯ä»¥å®ç°çš„åŠŸèƒ½**:

âœ… **åŸºç¡€é£Ÿç‰©è¯†åˆ«**
âœ… **æœ¬åœ°æ•°æ®å­˜å‚¨**
âœ… **æ•°æ®å¯è§†åŒ–**
âœ… **ç›®æ ‡ç®¡ç†**
âœ… **æé†’åŠŸèƒ½**ï¼ˆæµè§ˆå™¨æœ¬åœ°ï¼‰

---

### 3. æ€§èƒ½é™åˆ¶ âš ï¸

**Workers CPUæ—¶é—´é™åˆ¶**:
```
å…è´¹å¥—é¤: 10ms/è¯·æ±‚
ä»˜è´¹å¥—é¤: 50ms/è¯·æ±‚

å½“å‰ä½¿ç”¨: ~2-5ms âœ…

å¯èƒ½è¶…é™çš„åœºæ™¯:
- å¤æ‚çš„å›¾ç‰‡å¤„ç† (>10ms)
- å¤§é‡æ•°æ®è®¡ç®— (>10ms)
- å¤šæ¬¡æ•°æ®åº“æŸ¥è¯¢ (>10ms)
```

**ç¼“è§£æ–¹æ¡ˆ**:
- å›¾ç‰‡å¤„ç†æ”¾åœ¨å‰ç«¯
- æ•°æ®è®¡ç®—æ”¾åœ¨å‰ç«¯
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

---

## è¶…å‡ºå…è´¹é¢åº¦åçš„æˆæœ¬

### Cloudflare Workers ä»˜è´¹å®šä»·

**Workers Paid Plan**: $5/æœˆ
- è¯·æ±‚æ•°: 1000ä¸‡æ¬¡/æœˆï¼ˆè¶…å‡º$0.50/ç™¾ä¸‡æ¬¡ï¼‰
- CPUæ—¶é—´: 50ms/è¯·æ±‚ï¼ˆè¶…å‡º$0.02/ç™¾ä¸‡GB-sï¼‰
- è„šæœ¬å¤§å°: 10MB

**è®¡ç®—ç¤ºä¾‹**:
```
å‡è®¾: 10ä¸‡DAUï¼Œæ¯äºº10æ¬¡è¯†åˆ«

æ¯æ—¥è¯·æ±‚: 100,000 Ã— 10 = 1,000,000æ¬¡
æ¯æœˆè¯·æ±‚: 1,000,000 Ã— 30 = 30,000,000æ¬¡

æˆæœ¬:
- åŸºç¡€è´¹ç”¨: $5
- è¶…å‡ºè´¹ç”¨: (30M - 10M) Ã— $0.50/M = $10
- æ€»è®¡: $15/æœˆ
```

---

### Cloudflare D1 ä»˜è´¹å®šä»·

**D1 å®šä»·**:
- å­˜å‚¨: $0.75/GB/æœˆ
- è¯»å–: $0.001/ç™¾ä¸‡æ¬¡
- å†™å…¥: $1.00/ç™¾ä¸‡æ¬¡

**è®¡ç®—ç¤ºä¾‹**:
```
å‡è®¾: 10ä¸‡ç”¨æˆ·ï¼Œæ¯äºº100æ¡è®°å½•

å­˜å‚¨: 10ä¸‡ Ã— 100 Ã— 1KB = 10GB
æˆæœ¬: 10GB Ã— $0.75 = $7.5/æœˆ

è¯»å–: 10ä¸‡ Ã— 100æ¬¡/å¤© = 1000ä¸‡æ¬¡/å¤©
æˆæœ¬: 1000ä¸‡ Ã— 30 Ã— $0.001/M = $300/æœˆ âš ï¸

å†™å…¥: 10ä¸‡ Ã— 10æ¬¡/å¤© = 100ä¸‡æ¬¡/å¤©
æˆæœ¬: 100ä¸‡ Ã— 30 Ã— $1/M = $30/æœˆ
```

**ç»“è®º**: D1æˆæœ¬å¯èƒ½å¾ˆé«˜ï¼Œéœ€è¦ä¼˜åŒ–æŸ¥è¯¢

---

## ä¼˜åŒ–å»ºè®®

### 1. é™ä½Workersè¯·æ±‚æ•°

**ç­–ç•¥**:
```javascript
// å‰ç«¯ç¼“å­˜
const cache = new Map();

async function analyzeFood(image) {
  const hash = await hashImage(image);
  
  // æ£€æŸ¥ç¼“å­˜
  if (cache.has(hash)) {
    return cache.get(hash);
  }
  
  // è°ƒç”¨API
  const result = await fetch('/api/analyze', {
    method: 'POST',
    body: JSON.stringify({ image })
  });
  
  // ç¼“å­˜ç»“æœ
  cache.set(hash, result);
  return result;
}
```

**æ•ˆæœ**: å‡å°‘30-50%çš„é‡å¤è¯·æ±‚

---

### 2. ä¼˜åŒ–å›¾ç‰‡å¤§å°

**ç­–ç•¥**:
```javascript
// å‰ç«¯å‹ç¼©
async function compressImage(file) {
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  
  // é™åˆ¶æœ€å¤§å°ºå¯¸
  const maxSize = 1024;
  canvas.width = Math.min(img.width, maxSize);
  canvas.height = Math.min(img.height, maxSize);
  
  // å‹ç¼©è´¨é‡
  return canvas.toDataURL('image/jpeg', 0.8);
}
```

**æ•ˆæœ**: 
- å‡å°‘ä¼ è¾“æ—¶é—´
- é™ä½è±†åŒ…APIæˆæœ¬ï¼ˆtokenæ•°é‡ï¼‰
- æå‡ç”¨æˆ·ä½“éªŒ

---

### 3. å®ç°è¯·æ±‚é™æµ

**ç­–ç•¥**:
```javascript
// å‰ç«¯é™æµ
const rateLimiter = {
  lastRequest: 0,
  minInterval: 2000, // 2ç§’
  
  async checkLimit() {
    const now = Date.now();
    if (now - this.lastRequest < this.minInterval) {
      throw new Error('è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•');
    }
    this.lastRequest = now;
  }
};
```

**æ•ˆæœ**: é˜²æ­¢æ¶æ„åˆ·é‡

---

## éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰å‡†å¤‡

- [ ] 1. æ³¨å†ŒCloudflareè´¦å·
- [ ] 2. è·å–è±†åŒ…AI APIå¯†é’¥
- [ ] 3. é…ç½®ç¯å¢ƒå˜é‡
- [ ] 4. æµ‹è¯•æœ¬åœ°æ„å»º
- [ ] 5. ä¼˜åŒ–å›¾ç‰‡èµ„æº
- [ ] 6. é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰

### Pageséƒ¨ç½²æ­¥éª¤

```bash
# 1. æ„å»ºå‰ç«¯
npm run build

# 2. è¿æ¥GitHubä»“åº“åˆ°Cloudflare Pages
# æˆ–æ‰‹åŠ¨ä¸Šä¼ distç›®å½•

# 3. é…ç½®æ„å»ºè®¾ç½®
Build command: npm run build
Build output directory: dist
```

### Workerséƒ¨ç½²æ­¥éª¤

```bash
# 1. å®‰è£…wrangler
npm install -g wrangler

# 2. ç™»å½•Cloudflare
wrangler login

# 3. é…ç½®ç¯å¢ƒå˜é‡
wrangler secret put DOUBAO_API_KEY
wrangler secret put DOUBAO_API_ENDPOINT

# 4. éƒ¨ç½²
cd workers
wrangler deploy
```

---

## ç›‘æ§ä¸å‘Šè­¦

### å…è´¹ç›‘æ§å·¥å…·

**Cloudflare Analytics** (å…è´¹):
- è¯·æ±‚æ•°ç»Ÿè®¡
- å¸¦å®½ä½¿ç”¨
- é”™è¯¯ç‡
- å“åº”æ—¶é—´

**è®¾ç½®å‘Šè­¦**:
```javascript
// Workersä¸­æ·»åŠ ç›‘æ§
export default {
  async fetch(request, env) {
    const start = Date.now();
    
    try {
      const response = await handleRequest(request);
      
      // è®°å½•æˆåŠŸ
      await logMetric(env, {
        type: 'success',
        duration: Date.now() - start
      });
      
      return response;
    } catch (error) {
      // è®°å½•å¤±è´¥
      await logMetric(env, {
        type: 'error',
        error: error.message
      });
      
      throw error;
    }
  }
};
```

---

## é£é™©è¯„ä¼°

### é«˜é£é™© ğŸ”´

**1. è±†åŒ…APIæˆæœ¬å¤±æ§**
- é£é™©: æ¶æ„åˆ·é‡å¯¼è‡´APIè´¹ç”¨æš´å¢
- ç¼“è§£: å®ç°ä¸¥æ ¼çš„é™æµæœºåˆ¶
- ç›‘æ§: æ¯æ—¥æ£€æŸ¥APIä½¿ç”¨é‡

**2. Workersè¯·æ±‚è¶…é™**
- é£é™©: çªç„¶æµé‡æ¿€å¢è¶…è¿‡10ä¸‡æ¬¡/å¤©
- ç¼“è§£: å®ç°å‰ç«¯ç¼“å­˜å’Œé™æµ
- ç›‘æ§: è®¾ç½®å‘Šè­¦ï¼ˆ>8ä¸‡æ¬¡/å¤©ï¼‰

### ä¸­é£é™© ğŸŸ¡

**3. ç”¨æˆ·å¢é•¿è¶…é¢„æœŸ**
- é£é™©: ç”¨æˆ·é‡è¶…è¿‡å…è´¹é¢åº¦æ”¯æ’‘èŒƒå›´
- ç¼“è§£: æå‰å‡†å¤‡ä»˜è´¹æ–¹æ¡ˆ
- ç›‘æ§: è·Ÿè¸ªDAUå¢é•¿è¶‹åŠ¿

**4. åŠŸèƒ½æ‰©å±•å—é™**
- é£é™©: æ–°åŠŸèƒ½éœ€è¦è¶…å‡ºå…è´¹é¢åº¦çš„èµ„æº
- ç¼“è§£: è¯„ä¼°åŠŸèƒ½ä¼˜å…ˆçº§
- ç›‘æ§: å®šæœŸè¯„ä¼°èµ„æºä½¿ç”¨

### ä½é£é™© ğŸŸ¢

**5. å¸¦å®½è¶…é™**
- é£é™©: Pageså¸¦å®½æ— é™ï¼Œä¸ä¼šè¶…é™
- ç¼“è§£: æ— éœ€ç¼“è§£
- ç›‘æ§: å®šæœŸæ£€æŸ¥å³å¯

---

## æœ€ç»ˆå»ºè®®

### MVPé˜¶æ®µï¼ˆå½“å‰ï¼‰

**éƒ¨ç½²æ–¹æ¡ˆ**: âœ… **Cloudflare å…è´¹å¥—é¤**

**ç†ç”±**:
1. å®Œå…¨æ»¡è¶³å½“å‰åŠŸèƒ½éœ€æ±‚
2. é›¶åŸºç¡€è®¾æ–½æˆæœ¬
3. å¯æ”¯æ’‘1000+ DAU
4. å¿«é€Ÿéƒ¨ç½²å’Œè¿­ä»£

**å”¯ä¸€æˆæœ¬**: è±†åŒ…AI APIè´¹ç”¨ï¼ˆ$15-50/æœˆï¼‰

---

### æˆé•¿é˜¶æ®µï¼ˆ1000-10000 DAUï¼‰

**éƒ¨ç½²æ–¹æ¡ˆ**: âœ… **Cloudflare å…è´¹å¥—é¤** + ä¼˜åŒ–

**ä¼˜åŒ–æªæ–½**:
1. å®ç°å‰ç«¯ç¼“å­˜
2. ä¼˜åŒ–å›¾ç‰‡å‹ç¼©
3. ä¸¥æ ¼é™æµæ§åˆ¶
4. ç›‘æ§APIä½¿ç”¨

**é¢„ä¼°æˆæœ¬**: $50-200/æœˆï¼ˆä¸»è¦æ˜¯AI APIï¼‰

---

### å•†ä¸šåŒ–é˜¶æ®µï¼ˆ>10000 DAUï¼‰

**éƒ¨ç½²æ–¹æ¡ˆ**: âš ï¸ **éœ€è¦ä»˜è´¹å¥—é¤**

**å‡çº§é¡¹ç›®**:
1. Workers Paid ($5/æœˆ + è¶…å‡ºè´¹ç”¨)
2. D1 Database (æŒ‰ä½¿ç”¨é‡)
3. KV Storage (æŒ‰ä½¿ç”¨é‡)
4. R2 Storage (æŒ‰ä½¿ç”¨é‡)

**é¢„ä¼°æˆæœ¬**: $200-500/æœˆ

---

## æ€»ç»“

### æ ¸å¿ƒç»“è®º

| é˜¶æ®µ | ç”¨æˆ·è§„æ¨¡ | Cloudflareæˆæœ¬ | AI APIæˆæœ¬ | æ€»æˆæœ¬ | å¯è¡Œæ€§ |
|------|---------|---------------|-----------|--------|--------|
| MVP | <1000 DAU | **$0** | $15-50 | $15-50 | âœ… å®Œå…¨å¯è¡Œ |
| æˆé•¿ | 1K-10K DAU | **$0** | $50-200 | $50-200 | âœ… å¯è¡Œ |
| å•†ä¸šåŒ– | >10K DAU | $50-200 | $200-500 | $250-700 | âš ï¸ éœ€è¦ä»˜è´¹ |

### å…³é”®è¦ç‚¹

1. **å½“å‰é¡¹ç›®å®Œå…¨é€‚åˆå…è´¹éƒ¨ç½²** âœ…
2. **å…è´¹å¥—é¤å¯æ”¯æ’‘1ä¸‡æ—¥æ´»ç”¨æˆ·** âœ…
3. **ä¸»è¦æˆæœ¬æ˜¯AI APIè°ƒç”¨è´¹ç”¨** âš ï¸
4. **å•†ä¸šåŒ–åéœ€è¦å‡çº§åˆ°ä»˜è´¹å¥—é¤** âš ï¸

### è¡ŒåŠ¨å»ºè®®

**ç«‹å³è¡ŒåŠ¨**:
1. âœ… ä½¿ç”¨Cloudflareå…è´¹å¥—é¤éƒ¨ç½²
2. âœ… å®ç°å‰ç«¯ç¼“å­˜å’Œé™æµ
3. âœ… ç›‘æ§APIä½¿ç”¨é‡
4. âœ… ä¼˜åŒ–å›¾ç‰‡å‹ç¼©

**æœªæ¥è§„åˆ’**:
1. å½“DAU > 5000æ—¶ï¼Œè¯„ä¼°ä»˜è´¹æ–¹æ¡ˆ
2. å½“éœ€è¦ç”¨æˆ·ç³»ç»Ÿæ—¶ï¼Œå‡çº§åˆ°ä»˜è´¹å¥—é¤
3. æŒç»­ä¼˜åŒ–ä»¥é™ä½æˆæœ¬

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-11-20  
**ç»“è®º**: å½“å‰é¡¹ç›®**å®Œå…¨é€‚åˆ**åœ¨Cloudflareå…è´¹å¥—é¤ä¸Šéƒ¨ç½²ï¼
